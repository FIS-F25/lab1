# Covert Channels

A covert channel is a secret communication tunnel for hiding data within benign network traffic.

- Typically used for secret communication with a backdoor or data exfiltration.
- Exfiltrated data can be sent over protocols not intended for communication (e.g., ICMP, DHCP, ARP).

## Practice

The simplest example hides data in the payload or padding of an ICMP ping message.

Open two terminals (`Alt+n`) to experiment

- Terminal 1: Sniffer

  ```execute
  sudo tcpdump -ilo -A 'icmp'
  ```

- Terminal 2: exfiltrator, sends out `OK` in ping payload.

  ```execute
  prefix: "Example"
  title: "using hping3"
  command: hping3 -1 -c 1 127.0.0.1 -e 'OK'
  ```

## Exercise 5

Write `iptables` command to block all outgoing ping requests unless its destined for internal hosts (private IP range). Explain the command and verify it works by pinging `renderer` container one time, and `8.8.8.8` another.

## Bonus Task

In the very first scenario with Alice and Bob, write some script (Python/Bash) around `tcpdump` to allow Eve to see a clean conversation (only the messages exchanged between Alice and Bob). Example:

```bash
$ Eve@Hacker > sudo ./sniffer.sh
Alice to Bob: Hello!
Bob to Alice: Hi
...
```

