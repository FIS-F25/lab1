# Covert Channels

A covert channel is a secret communication tunnel for hiding data within benign network traffic.

- Typically used for secret communication with a backdoor or data exfiltration.
- Exfiltrated data can be sent over protocols not intended for communication (e.g., ICMP, DHCP, ARP).

## Practice

The simplest example hides data in the payload or padding of an ICMP ping message.

Open two terminals (`Alt+n`) to experiment

- Terminal 1: Sniffer

  ```execute
  sudo tcpdump -ilo -A 'icmp'
  ```

- Terminal 2: exfiltrator, sends out `OK` in ping payload.

  ```execute
  prefix: "Example 2"
  title: "using hping3"
  command: hping3 -1 -c 1 127.0.0.1 -e 'OK'
  ```

## Exercise 6

Write `iptables` command to block all outgoing ping requests unless its destined for internal hosts. Explain the command and verify it works.

